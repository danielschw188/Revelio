library(dplyr)
library(xlsx)
library(biomaRt)
library(mygene)
library(psych)
library(DropletUtils)

setClass('Revelio',
         slots = list(datasetInfo = 'list',
                      DGEs = 'list',
                      cellInfo = 'list',
                      geneInfo = 'list',
                      transformedData = 'list',
                      velocityData = 'list',
                      stabilityIndex = 'list'))

#'Create Revelio Object.
#'
#' 'createRevelioObject' returns a Revelio object according to the specified parameters.
#'
#'testtest
#'
#'@param datasetID ID should correspond to ID provided in supplementary file.
#'@return Returns Revelio object.
#'
#'
createRevelioObject <- function(datasetID,
                                cellType = 'unknown',
                                sequTechnique = 'unknown',
                                dataPath = 'unknown',
                                intronDataExists = FALSE,
                                intronicDataPath = 'unknown',
                                doStabilityAnalysis = FALSE,
                                lowernGeneCutoff = 0,
                                uppernUMICutoff = 10^7,
                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                ccPhaseAssignGeneBucketListFileLocation = 'unknown',
                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                pcaGenes = 'variableGenes',
                                goldStandardWeights = '',
                                thresholdsForPCWeightSignificance = 0.05,
                                ccDurationG1 = 0.487*19.33,
                                ccDurationS = 0.392*19.33,
                                ccDurationG2 = 0.093*19.33,
                                ccDurationM = 0.028*19.33,
                                ccDurationTotal = 19.33,
                                velTimeStep = 1,
                                velGammaCutOff = 0.1,
                                velSpearmanCorCutOff = 0.1,
                                velMeanUnsplicedCutOff = 0.005,
                                velMeanSplicedCutOff = 0.01,
                                velCCGridAmountOfPoints = 50,
                                velCCGridSigma = c(0.6, 1.5),
                                velWhichThirdDimensionsToGetVelocityFor = c(3, 4, 5),
                                stabilityIndexNumberOfIntervals = 10,
                                stabilityIndexCorrelationType = 'kendall',
                                stabilityIndexpValueForCorrelation = 0.05){

  startTime <- Sys.time()
  cat(paste(Sys.time(), ': reading data: ', sep = ''))

  dataList <- new('Revelio')

  datasetInfo <- defineDatasetParameters()
  if (datasetID%in%names(datasetInfo)){
    dataList@datasetInfo <- datasetInfo[[datasetID]]
  }else{
    dataList@datasetInfo <- list(datasetID = datasetID,
                                 cellType = cellType,
                                 sequTechnique = sequTechnique,
                                 dataPath = dataPath,
                                 intronDataExists = intronDataExists,
                                 intronicDataPath = intronicDataPath,
                                 doStabilityAnalysis = doStabilityAnalysis,
                                 lowernGeneCutoff = lowernGeneCutoff,
                                 uppernUMICutoff = uppernUMICutoff,
                                 ccPhaseAssignBasedOnIndividualBatches = ccPhaseAssignBasedOnIndividualBatches,
                                 ccPhaseAssignGeneBucketListFileLocation = ccPhaseAssignGeneBucketListFileLocation,
                                 ccPhaseAssignGeneBucketListSheetIndex = ccPhaseAssignGeneBucketListSheetIndex,
                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = ccPhaseAssignThresholdForCorSingleGeneToAvgExpression,
                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores,
                                 ccPhaseAssignThresholdHighestPhaseScore = ccPhaseAssignThresholdHighestPhaseScore,
                                 ccPhaseAssignThresholdSecondHighestPhaseScore = ccPhaseAssignThresholdSecondHighestPhaseScore,
                                 pcaGenes = pcaGenes,
                                 goldStandardWeights = goldStandardWeights,
                                 thresholdsForPCWeightSignificance = thresholdsForPCWeightSignificance,
                                 ccDurationG1 = ccDurationG1,
                                 ccDurationG2 = ccDurationG2,
                                 ccDurationM = ccDurationM,
                                 ccDurationTotal = ccDurationTotal,
                                 velTimeStep = velTimeStep,
                                 velGammaCutOff = velGammaCutOff,
                                 velSpearmanCorCutOff = velSpearmanCorCutOff,
                                 velMeanUnsplicedCutOff = velMeanUnsplicedCutOff,
                                 velMeanSplicedCutOff = velMeanSplicedCutOff,
                                 velCCGridAmountOfPoints = velCCGridAmountOfPoints,
                                 velCCGridSigma = velCCGridSigma,
                                 velWhichThirdDimensionsToGetVelocityFor = velWhichThirdDimensionsToGetVelocityFor,
                                 stabilityIndexNumberOfIntervals = stabilityIndexNumberOfIntervals,
                                 stabilityIndexCorrelationType = stabilityIndexCorrelationType,
                                 stabilityIndexpValueForCorrelation = stabilityIndexpValueForCorrelation)
  }

  dataList@DGEs$countData <- as.data.frame(readRDS(dataList@datasetInfo$dataPath))

  cat(paste(round(Sys.time()-startTime, 2), attr(Sys.time()-startTime, 'units'), '\n', sep = ''))
  return(dataList)
}
defineDatasetParameters <- function(){
  datasetInfo <- list(sf002 = list(datasetID = 'sf002',
                                   cellType = 'HeLa',
                                   sequTechnique = 'ds',
                                   dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO.rds',
                                   intronDataExists = FALSE,
                                   intronicDataPath = '',
                                   doStabilityAnalysis = TRUE,
                                   lowernGeneCutoff = 1200,
                                   uppernUMICutoff = 70000,
                                   ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                   ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                   ccPhaseAssignGeneBucketListSheetIndex = 1,
                                   ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                   ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                   ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                   ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                   pcaGenes = 'variableGenes',
                                   goldStandardWeights = '',
                                   thresholdsForPCWeightSignificance = 0.05),
                      sf002NoOutlierThresholds = list(datasetID = 'sf002NoOutlierThresholds',
                                                      cellType = 'HeLa',
                                                      sequTechnique = 'ds',
                                                      dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO.rds',
                                                      intronDataExists = FALSE,
                                                      intronicDataPath = '',
                                                      doStabilityAnalysis = TRUE,
                                                      lowernGeneCutoff = 1200,
                                                      uppernUMICutoff = 70000,
                                                      ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                      ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                      ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                      ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                      ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 2,
                                                      ccPhaseAssignThresholdHighestPhaseScore = 0,
                                                      ccPhaseAssignThresholdSecondHighestPhaseScore = 3,
                                                      pcaGenes = 'variableGenes',
                                                      goldStandardWeights = '',
                                                      thresholdsForPCWeightSignificance = 0.05),
                      sf002Vel = list(datasetID = 'sf002Vel',
                                      cellType = 'HeLa',
                                      sequTechnique = 'ds',
                                      dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO.rds',
                                      intronDataExists = TRUE,
                                      intronicDataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_intronicData.rds',
                                      doStabilityAnalysis = TRUE,
                                      lowernGeneCutoff = 1200,
                                      uppernUMICutoff = 70000,
                                      ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                      ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                      ccPhaseAssignGeneBucketListSheetIndex = 1,
                                      ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                      ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                      ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                      ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                      pcaGenes = 'variableGenes',
                                      goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsSf002.rds'),
                                      thresholdsForPCWeightSignificance = 0.05),
                      sf002AllGenes = list(datasetID = 'sf002AllGenes',
                                           cellType = 'HeLa',
                                           sequTechnique = 'ds',
                                           dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO.rds',
                                           intronDataExists = TRUE,
                                           intronicDataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_intronicData.rds',
                                           doStabilityAnalysis = TRUE,
                                           lowernGeneCutoff = 1200,
                                           uppernUMICutoff = 70000,
                                           ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                           ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                           ccPhaseAssignGeneBucketListSheetIndex = 1,
                                           ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                           ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                           ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                           ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                           pcaGenes = 'allGenes',
                                           goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsSf002.rds'),
                                           thresholdsForPCWeightSignificance = 0.01),
                      ds13fixed = list(datasetID = 'ds13fixed',
                                       cellType = 'HEK',
                                       sequTechnique = 'ds',
                                       dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds13fixed/ds13fixed_OnlyHEK.rds',
                                       intronDataExists = FALSE,
                                       intronicDataPath = '',
                                       doStabilityAnalysis = FALSE,
                                       lowernGeneCutoff = 1200,
                                       uppernUMICutoff = 28000,
                                       ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                       ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                       ccPhaseAssignGeneBucketListSheetIndex = 1,
                                       ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                       ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                       ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                       ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                       pcaGenes = 'variableGenes',
                                       goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsSf002.rds'),
                                       thresholdsForPCWeightSignificance = 0.05),
                      ds13fixedVel = list(datasetID = 'ds13fixedVel',
                                          cellType = 'HEK',
                                          sequTechnique = 'ds',
                                          dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds13fixed/ds13fixed_OnlyHEK.rds',
                                          intronDataExists = TRUE,
                                          intronicDataPath = '~/Studium Doktorarbeit/ExperimentalData/ds13fixed/ds13fixed_OnlyHEK_intronicData.rds',
                                          doStabilityAnalysis = TRUE,
                                          lowernGeneCutoff = 1200,
                                          uppernUMICutoff = 28000,
                                          ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                          ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                          ccPhaseAssignGeneBucketListSheetIndex = 1,
                                          ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                          ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                          ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                          ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                          pcaGenes = 'variableGenes',
                                          goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                          thresholdsForPCWeightSignificance = 0.05),
                      ds13fixedAllGenes = list(datasetID = 'ds13fixedAllGenes',
                                               cellType = 'HEK',
                                               sequTechnique = 'ds',
                                               dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds13fixed/ds13fixed_OnlyHEK.rds',
                                               intronDataExists = TRUE,
                                               intronicDataPath = '~/Studium Doktorarbeit/ExperimentalData/ds13fixed/ds13fixed_OnlyHEK_intronicData.rds',
                                               doStabilityAnalysis = FALSE,
                                               lowernGeneCutoff = 1200,
                                               uppernUMICutoff = 28000,
                                               ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                               ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                               ccPhaseAssignGeneBucketListSheetIndex = 1,
                                               ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                               ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                               ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                               ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                               pcaGenes = 'allGenes',
                                               goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                               thresholdsForPCWeightSignificance = 0.05),
                      ds46 = list(datasetID = 'ds46',
                                  cellType = 'HeLa',
                                  sequTechnique = 'ds',
                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds46/ds46.rds',
                                  intronDataExists = FALSE,
                                  intronicDataPath = '',
                                  doStabilityAnalysis = FALSE,
                                  lowernGeneCutoff = 1000,
                                  uppernUMICutoff = 100000,
                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                  pcaGenes = 'variableGenes',
                                  goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsSf002.rds'),
                                  thresholdsForPCWeightSignificance = 0.05),
                      ds46Vel = list(datasetID = 'ds46Vel',
                                     cellType = 'HeLa',
                                     sequTechnique = 'ds',
                                     dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds46/ds46.rds',
                                     intronDataExists = TRUE,
                                     intronicDataPath = '~/Studium Doktorarbeit/ExperimentalData/ds46/ds46_intronicData.rds',
                                     doStabilityAnalysis = TRUE,
                                     lowernGeneCutoff = 1000,
                                     uppernUMICutoff = 100000,
                                     ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                     ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                     ccPhaseAssignGeneBucketListSheetIndex = 1,
                                     ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                     ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                     ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                     ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                     pcaGenes = 'variableGenes',
                                     goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsSf002.rds'),
                                     thresholdsForPCWeightSignificance = 0.05),
                      ds46AllGenes = list(datasetID = 'ds46AllGenes',
                                          cellType = 'HeLa',
                                          sequTechnique = 'ds',
                                          dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds46/ds46.rds',
                                          intronDataExists = TRUE,
                                          intronicDataPath = '~/Studium Doktorarbeit/ExperimentalData/ds46/ds46_intronicData.rds',
                                          doStabilityAnalysis = FALSE,
                                          lowernGeneCutoff = 1000,
                                          uppernUMICutoff = 100000,
                                          ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                          ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                          ccPhaseAssignGeneBucketListSheetIndex = 1,
                                          ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                          ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                          ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                          ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                          pcaGenes = 'allGenes',
                                          goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsSf002.rds'),
                                          thresholdsForPCWeightSignificance = 0.05),
                      ds21fixed3T3 = list(datasetID = 'ds21fixed3T3',
                                          cellType = '3T3',
                                          sequTechnique = 'ds',
                                          dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds21fixed3T3/ds21fixed3T3.rds',
                                          intronDataExists = FALSE,
                                          intronicDataPath = '',
                                          doStabilityAnalysis = FALSE,
                                          lowernGeneCutoff = 1000,
                                          uppernUMICutoff = 40000,
                                          ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                          ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/cell_cycle_genes_Macosko_3T3.xlsx',
                                          ccPhaseAssignGeneBucketListSheetIndex = 1,
                                          ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                          ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                          ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                          ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                          pcaGenes = 'variableGenes',
                                          goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                          thresholdsForPCWeightSignificance = 0.05),
                      ds21fixed3T3Vel = list(datasetID = 'ds21fixed3T3Vel',
                                             cellType = '3T3',
                                             sequTechnique = 'ds',
                                             dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds21fixed3T3/ds21fixed3T3.rds',
                                             intronDataExists = TRUE,
                                             intronicDataPath = '~/Studium Doktorarbeit/ExperimentalData/ds21fixed3T3/ds21fixed3T3_intronicData.rds',
                                             doStabilityAnalysis = TRUE,
                                             lowernGeneCutoff = 1000,
                                             uppernUMICutoff = 40000,
                                             ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                             ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/cell_cycle_genes_Macosko_3T3.xlsx',
                                             ccPhaseAssignGeneBucketListSheetIndex = 1,
                                             ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                             ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                             ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                             ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                             pcaGenes = 'variableGenes',
                                             goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                             thresholdsForPCWeightSignificance = 0.05),
                      ds21fixed3T3AllGenes = list(datasetID = 'ds21fixed3T3AllGenes',
                                                  cellType = '3T3',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/ds21fixed3T3/ds21fixed3T3.rds',
                                                  intronDataExists = TRUE,
                                                  intronicDataPath = '~/Studium Doktorarbeit/ExperimentalData/ds21fixed3T3/ds21fixed3T3_intronicData.rds',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1000,
                                                  uppernUMICutoff = 40000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/cell_cycle_genes_Macosko_3T3.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'allGenes',
                                                  goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                  thresholdsForPCWeightSignificance = 0.05),
                      pooledSlamDs03060120_SelfAnnotation = list(datasetID = 'pooledSlamDs03060120_SelfAnnotation',
                                                                 cellType = 'HEK',
                                                                 sequTechnique = 'ds',
                                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlamDs03060120_SelfAnnotation.rds',
                                                                 intronDataExists = FALSE,
                                                                 intronicDataPath = '',
                                                                 doStabilityAnalysis = FALSE,
                                                                 lowernGeneCutoff = 400,
                                                                 uppernUMICutoff = 20000,
                                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                                 pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                                 goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                                 thresholdsForPCWeightSignificance = 0.05),
                      pooledSlamDs03060120_DSAnnotation = list(datasetID = 'pooledSlamDs03060120_DSAnnotation',
                                                               cellType = 'HEK',
                                                               sequTechnique = 'ds',
                                                               dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlamDs03060120_DSAnnotation.rds',
                                                               intronDataExists = FALSE,
                                                               intronicDataPath = '',
                                                               doStabilityAnalysis = FALSE,
                                                               lowernGeneCutoff = 400,
                                                               uppernUMICutoff = 20000,
                                                               ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                               ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                               ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                               ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                               ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                               ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                               ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                               pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                               goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                               thresholdsForPCWeightSignificance = 0.05),
                      pooledSlamNadia0 = list(datasetID = 'pooledSlamNadia0',
                                              cellType = 'HEK',
                                              sequTechnique = 'nadia',
                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlamNadia0.rds',
                                              intronDataExists = FALSE,
                                              intronicDataPath = '',
                                              doStabilityAnalysis = FALSE,
                                              lowernGeneCutoff = 1200,
                                              uppernUMICutoff = 70000,
                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                              pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                              goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                              thresholdsForPCWeightSignificance = 0.05),
                      pooledSlamNadia15 = list(datasetID = 'pooledSlamNadia15',
                                               cellType = 'HEK',
                                               sequTechnique = 'nadia',
                                               dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlamNadia15.rds',
                                               intronDataExists = FALSE,
                                               intronicDataPath = '',
                                               doStabilityAnalysis = FALSE,
                                               lowernGeneCutoff = 1200,
                                               uppernUMICutoff = 70000,
                                               ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                               ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                               ccPhaseAssignGeneBucketListSheetIndex = 1,
                                               ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                               ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                               ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                               ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                               pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                               goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                               thresholdsForPCWeightSignificance = 0.05),
                      pooledSlamNadia24h = list(datasetID = 'pooledSlamNadia24h',
                                                cellType = 'HEK',
                                                sequTechnique = 'nadia',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlamNadia24h.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200,
                                                uppernUMICutoff = 70000,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                thresholdsForPCWeightSignificance = 0.05),
                      pooledSlamNadia15_SelfAnnotation = list(datasetID = 'pooledSlamNadia15_SelfAnnotation',
                                                              cellType = 'HEK',
                                                              sequTechnique = 'nadia',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlamNadia15_SelfAnnotation.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 1200,
                                                              uppernUMICutoff = 70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                              goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                              thresholdsForPCWeightSignificance = 0.05),
                      nadiaSlam3Time15_SelfAnnotation = list(datasetID = 'nadiaSlam3Time15_SelfAnnotation',
                                                             cellType = 'HEK',
                                                             sequTechnique = 'nadia',
                                                             dataPath = '~/Studium Doktorarbeit/ExperimentalData/nadiaSlam3/nadiaSlam3Time15_SelfAnnotation.rds',
                                                             intronDataExists = FALSE,
                                                             intronicDataPath = '',
                                                             doStabilityAnalysis = FALSE,
                                                             lowernGeneCutoff = 1200,
                                                             uppernUMICutoff = 70000,
                                                             ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                             ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                             ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                             ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                             ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                             ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                             ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                             pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                             goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                             thresholdsForPCWeightSignificance = 0.05),
                      nadiaSlam4Time15_SelfAnnotation = list(datasetID = 'nadiaSlam4Time15_SelfAnnotation',
                                                             cellType = 'HEK',
                                                             sequTechnique = 'nadia',
                                                             dataPath = '~/Studium Doktorarbeit/ExperimentalData/nadiaSlam4/nadiaSlam4Time15_SelfAnnotation.rds',
                                                             intronDataExists = FALSE,
                                                             intronicDataPath = '',
                                                             doStabilityAnalysis = FALSE,
                                                             lowernGeneCutoff = 1200,
                                                             uppernUMICutoff = 70000,
                                                             ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                             ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                             ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                             ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                             ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                             ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                             ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                             pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                             goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                             thresholdsForPCWeightSignificance = 0.05),
                      pooledSlamNadia15_DSAnnotation = list(datasetID = 'pooledSlamNadia15_DSAnnotation',
                                                            cellType = 'HEK',
                                                            sequTechnique = 'nadia',
                                                            dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlamNadia15_DSAnnotation.rds',
                                                            intronDataExists = FALSE,
                                                            intronicDataPath = '',
                                                            doStabilityAnalysis = FALSE,
                                                            lowernGeneCutoff = 1200,
                                                            uppernUMICutoff = 70000,
                                                            ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                            ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                            ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                            ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                            ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                            ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                            ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                            pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                            goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                            thresholdsForPCWeightSignificance = 0.05),
                      nadiaSlam3Time15_DSAnnotation = list(datasetID = 'nadiaSlam3Time15_DSAnnotation',
                                                           cellType = 'HEK',
                                                           sequTechnique = 'nadia',
                                                           dataPath = '~/Studium Doktorarbeit/ExperimentalData/nadiaSlam3/nadiaSlam3Time15_DSAnnotation.rds',
                                                           intronDataExists = FALSE,
                                                           intronicDataPath = '',
                                                           doStabilityAnalysis = FALSE,
                                                           lowernGeneCutoff = 1200,
                                                           uppernUMICutoff = 70000,
                                                           ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                           ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                           ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                           ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                           ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                           ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                           ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                           pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                           goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                           thresholdsForPCWeightSignificance = 0.05),
                      nadiaSlam4Time15_DSAnnotation = list(datasetID = 'nadiaSlam4Time15_DSAnnotation',
                                                           cellType = 'HEK',
                                                           sequTechnique = 'nadia',
                                                           dataPath = '~/Studium Doktorarbeit/ExperimentalData/nadiaSlam4/nadiaSlam4Time15_DSAnnotation.rds',
                                                           intronDataExists = FALSE,
                                                           intronicDataPath = '',
                                                           doStabilityAnalysis = FALSE,
                                                           lowernGeneCutoff = 1200,
                                                           uppernUMICutoff = 70000,
                                                           ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                           ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                           ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                           ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                           ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                           ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                           ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                           pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                           goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                           thresholdsForPCWeightSignificance = 0.05),
                      pooledSlamNadia15_FilteredHaiyue = list(datasetID = 'pooledSlamNadia15_FilteredHaiyue',
                                                              cellType = 'HEK',
                                                              sequTechnique = 'nadia',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlamNadia15_FilteredHaiyue.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 1200,
                                                              uppernUMICutoff = 70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                              goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                              thresholdsForPCWeightSignificance = 0.05),
                      pooledSlam12Nadia15_FilteredHaiyue = list(datasetID = 'pooledSlam12Nadia15_FilteredHaiyue',
                                                                cellType = 'HEK',
                                                                sequTechnique = 'nadia',
                                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlam12Nadia15_FilteredHaiyue.rds',
                                                                intronDataExists = FALSE,
                                                                intronicDataPath = '',
                                                                doStabilityAnalysis = FALSE,
                                                                lowernGeneCutoff = 1200,
                                                                uppernUMICutoff = 70000,
                                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                                pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                                goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                                thresholdsForPCWeightSignificance = 0.05),
                      pooledSlam34Nadia15_FilteredHaiyue = list(datasetID = 'pooledSlam34Nadia15_FilteredHaiyue',
                                                                cellType = 'HEK',
                                                                sequTechnique = 'nadia',
                                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/pooledDataForSlamSeq/pooledSlam34Nadia15_FilteredHaiyue.rds',
                                                                intronDataExists = FALSE,
                                                                intronicDataPath = '',
                                                                doStabilityAnalysis = FALSE,
                                                                lowernGeneCutoff = 1200,
                                                                uppernUMICutoff = 70000,
                                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                                pcaGenes = rownames(readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds')),
                                                                goldStandardWeights = readRDS('~/Studium Doktorarbeit/ExperimentalData/Others/goldStandardDCWeightsDs13fixedViaSf002.rds'),
                                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled095 = list(datasetID = 'sf002Downsampled095',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.95.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.95,
                                                 uppernUMICutoff = 70000*0.95,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled09 = list(datasetID = 'sf002Downsampled09',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.9.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.9,
                                                uppernUMICutoff = 70000*0.9,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled085 = list(datasetID = 'sf002Downsampled085',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.85.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.85,
                                                 uppernUMICutoff = 70000*0.85,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled08 = list(datasetID = 'sf002Downsampled08',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.8.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.8,
                                                uppernUMICutoff = 70000*0.8,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled075 = list(datasetID = 'sf002Downsampled075',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.75.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.75,
                                                 uppernUMICutoff = 70000*0.75,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled07 = list(datasetID = 'sf002Downsampled07',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.7.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.7,
                                                uppernUMICutoff = 70000*0.7,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled065 = list(datasetID = 'sf002Downsampled065',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.65.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.65,
                                                 uppernUMICutoff = 70000*0.65,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled06 = list(datasetID = 'sf002Downsampled06',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.6.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.6,
                                                uppernUMICutoff = 70000*0.6,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled055 = list(datasetID = 'sf002Downsampled055',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.55.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.55,
                                                 uppernUMICutoff = 70000*0.55,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled05 = list(datasetID = 'sf002Downsampled05',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.5.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.5,
                                                uppernUMICutoff = 70000*0.5,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled045 = list(datasetID = 'sf002Downsampled045',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.45.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.45,
                                                 uppernUMICutoff = 70000*0.45,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled04 = list(datasetID = 'sf002Downsampled04',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.4.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.4,
                                                uppernUMICutoff = 70000*0.4,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled035 = list(datasetID = 'sf002Downsampled035',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.35.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.35,
                                                 uppernUMICutoff = 70000*0.35,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled03 = list(datasetID = 'sf002Downsampled03',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.3.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.3,
                                                uppernUMICutoff = 70000*0.3,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled025 = list(datasetID = 'sf002Downsampled025',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.25.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.25,
                                                 uppernUMICutoff = 70000*0.25,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled02 = list(datasetID = 'sf002Downsampled02',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.2.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.2,
                                                uppernUMICutoff = 70000*0.2,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled015 = list(datasetID = 'sf002Downsampled015',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.15.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.15,
                                                 uppernUMICutoff = 70000*0.15,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled01 = list(datasetID = 'sf002Downsampled01',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.1.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200*0.1,
                                                uppernUMICutoff = 70000*0.1,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      sf002Downsampled005 = list(datasetID = 'sf002Downsampled005',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_Downsampled0.05.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200*0.05,
                                                 uppernUMICutoff = 70000*0.05,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002scTransform = list(datasetID = 'sf002scTransform',
                                              cellType = 'HeLa',
                                              sequTechnique = 'ds',
                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_scTransform.rds',
                                              intronDataExists = FALSE,
                                              intronicDataPath = '',
                                              doStabilityAnalysis = FALSE,
                                              lowernGeneCutoff = 1200,
                                              uppernUMICutoff = 70000,
                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                              pcaGenes = 'variableGenes',
                                              goldStandardWeights = '',
                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled095 = list(datasetID = 'sf002CellsSampled095',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.95.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled09 = list(datasetID = 'sf002CellsSampled09',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.9.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled085 = list(datasetID = 'sf002CellsSampled085',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.85.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled08 = list(datasetID = 'sf002CellsSampled08',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.8.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled075 = list(datasetID = 'sf002CellsSampled075',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.75.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled07 = list(datasetID = 'sf002CellsSampled07',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.7.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled065 = list(datasetID = 'sf002CellsSampled065',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.65.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled06 = list(datasetID = 'sf002CellsSampled06',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.6.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled055 = list(datasetID = 'sf002CellsSampled055',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.55.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled05 = list(datasetID = 'sf002CellsSampled05',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.5.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled045 = list(datasetID = 'sf002CellsSampled045',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.45.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04 = list(datasetID = 'sf002CellsSampled04',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.4.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled035 = list(datasetID = 'sf002CellsSampled035',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.35.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled03 = list(datasetID = 'sf002CellsSampled03',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.3.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled025 = list(datasetID = 'sf002CellsSampled025',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.25.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled02 = list(datasetID = 'sf002CellsSampled02',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.2.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled015 = list(datasetID = 'sf002CellsSampled015',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.15.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled01 = list(datasetID = 'sf002CellsSampled01',
                                                 cellType = 'HeLa',
                                                 sequTechnique = 'ds',
                                                 dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.1.rds',
                                                 intronDataExists = FALSE,
                                                 intronicDataPath = '',
                                                 doStabilityAnalysis = FALSE,
                                                 lowernGeneCutoff = 1200,
                                                 uppernUMICutoff = 70000,
                                                 ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                 ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                 ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                 ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                 ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                 ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                 ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                 pcaGenes = 'variableGenes',
                                                 goldStandardWeights = '',
                                                 thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled005 = list(datasetID = 'sf002CellsSampled005',
                                                  cellType = 'HeLa',
                                                  sequTechnique = 'ds',
                                                  dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled0.05.rds',
                                                  intronDataExists = FALSE,
                                                  intronicDataPath = '',
                                                  doStabilityAnalysis = FALSE,
                                                  lowernGeneCutoff = 1200,
                                                  uppernUMICutoff = 70000,
                                                  ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                  ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                  ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                  ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                  ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                  ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                  ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                  pcaGenes = 'variableGenes',
                                                  goldStandardWeights = '',
                                                  thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled09 = list(datasetID = 'sf002CellsSampled04Downsampled09',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.9.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.9*1200,
                                                              uppernUMICutoff = 0.9*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled08 = list(datasetID = 'sf002CellsSampled04Downsampled08',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.8.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.8*1200,
                                                              uppernUMICutoff = 0.8*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled07 = list(datasetID = 'sf002CellsSampled04Downsampled07',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.7.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.7*1200,
                                                              uppernUMICutoff = 0.7*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled06 = list(datasetID = 'sf002CellsSampled04Downsampled06',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.6.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.6*1200,
                                                              uppernUMICutoff = 0.6*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled05 = list(datasetID = 'sf002CellsSampled04Downsampled05',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.5.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.5*1200,
                                                              uppernUMICutoff = 0.5*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled04 = list(datasetID = 'sf002CellsSampled04Downsampled04',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.4.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.4*1200,
                                                              uppernUMICutoff = 0.4*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled03 = list(datasetID = 'sf002CellsSampled04Downsampled03',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.3.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.3*1200,
                                                              uppernUMICutoff = 0.3*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled02 = list(datasetID = 'sf002CellsSampled04Downsampled02',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.2.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.2*1200,
                                                              uppernUMICutoff = 0.2*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002CellsSampled04Downsampled01 = list(datasetID = 'sf002CellsSampled04Downsampled01',
                                                              cellType = 'HeLa',
                                                              sequTechnique = 'ds',
                                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_WTAndAgo2KO_CellsSampled04_Downsampled0.1.rds',
                                                              intronDataExists = FALSE,
                                                              intronicDataPath = '',
                                                              doStabilityAnalysis = FALSE,
                                                              lowernGeneCutoff = 0.1*1200,
                                                              uppernUMICutoff = 0.1*70000,
                                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                              pcaGenes = 'variableGenes',
                                                              goldStandardWeights = '',
                                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002OnlyG1SAndS = list(datasetID = 'sf002OnlyG1SAndS',
                                              cellType = 'HeLa',
                                              sequTechnique = 'ds',
                                              dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_G1SAndSCells.rds',
                                              intronDataExists = FALSE,
                                              intronicDataPath = '',
                                              doStabilityAnalysis = FALSE,
                                              lowernGeneCutoff = 1200,
                                              uppernUMICutoff = 70000,
                                              ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                              ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                              ccPhaseAssignGeneBucketListSheetIndex = 1,
                                              ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                              ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                              ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                              ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                              pcaGenes = 'variableGenes',
                                              goldStandardWeights = '',
                                              thresholdsForPCWeightSignificance = 0.05),
                      sf002OnlyG2AndG2MAndMG1 = list(datasetID = 'sf002OnlyG2AndG2MAndMG1',
                                                     cellType = 'HeLa',
                                                     sequTechnique = 'ds',
                                                     dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_G2AndG2MAndMG1Cells.rds',
                                                     intronDataExists = FALSE,
                                                     intronicDataPath = '',
                                                     doStabilityAnalysis = FALSE,
                                                     lowernGeneCutoff = 1200,
                                                     uppernUMICutoff = 70000,
                                                     ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                     ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                     ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                     ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                     ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                     ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                     ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                     pcaGenes = 'variableGenes',
                                                     goldStandardWeights = '',
                                                     thresholdsForPCWeightSignificance = 0.05),
                      sf002OnlyG2MAndMG1 = list(datasetID = 'sf002OnlyG2MAndMG1',
                                                cellType = 'HeLa',
                                                sequTechnique = 'ds',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/sf002/sf002_G2MAndMG1Cells.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 1200,
                                                uppernUMICutoff = 70000,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      postMitoticPBMC10X = list(datasetID = 'postMitoticPBMC10X',
                                                cellType = 'PBMC',
                                                sequTechnique = '10X',
                                                dataPath = '~/Studium Doktorarbeit/ExperimentalData/postMitotic_pbmc10X.rds',
                                                intronDataExists = FALSE,
                                                intronicDataPath = '',
                                                doStabilityAnalysis = FALSE,
                                                lowernGeneCutoff = 300,
                                                uppernUMICutoff = 70000,
                                                ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                                ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                                ccPhaseAssignGeneBucketListSheetIndex = 1,
                                                ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                                ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                                ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                                ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                                pcaGenes = 'variableGenes',
                                                goldStandardWeights = '',
                                                thresholdsForPCWeightSignificance = 0.05),
                      Merfish = list(datasetID = 'Merfish',
                                     cellType = 'U2OS',
                                     sequTechnique = 'Merfish',
                                     dataPath = '~/Studium Doktorarbeit/ExperimentalData/Merfish/Merfish.rds',
                                     intronDataExists = FALSE,
                                     intronicDataPath = '',
                                     doStabilityAnalysis = FALSE,
                                     lowernGeneCutoff = 5000,
                                     uppernUMICutoff = 250000,
                                     ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                     ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                     ccPhaseAssignGeneBucketListSheetIndex = 1,
                                     ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                     ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                     ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                     ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                     pcaGenes = 'variableGenes',
                                     goldStandardWeights = '',
                                     thresholdsForPCWeightSignificance = 0.05),
                      MerfishB1B2 = list(datasetID = 'MerfishB1B2',
                                         cellType = 'U2OS',
                                         sequTechnique = 'Merfish',
                                         dataPath = '~/Studium Doktorarbeit/ExperimentalData/Merfish/MerfishB1B2.rds',
                                         intronDataExists = FALSE,
                                         intronicDataPath = '',
                                         doStabilityAnalysis = FALSE,
                                         lowernGeneCutoff = 5000,
                                         uppernUMICutoff = 250000,
                                         ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                         ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                         ccPhaseAssignGeneBucketListSheetIndex = 1,
                                         ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                         ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                         ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                         ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                         pcaGenes = 'variableGenes',
                                         goldStandardWeights = '',
                                         thresholdsForPCWeightSignificance = 0.05),
                      MerfishB1B3 = list(datasetID = 'MerfishB1B3',
                                         cellType = 'U2OS',
                                         sequTechnique = 'Merfish',
                                         dataPath = '~/Studium Doktorarbeit/ExperimentalData/Merfish/MerfishB1B3.rds',
                                         intronDataExists = FALSE,
                                         intronicDataPath = '',
                                         doStabilityAnalysis = FALSE,
                                         lowernGeneCutoff = 5000,
                                         uppernUMICutoff = 250000,
                                         ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                         ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                         ccPhaseAssignGeneBucketListSheetIndex = 1,
                                         ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                         ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                         ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                         ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                         pcaGenes = 'variableGenes',
                                         goldStandardWeights = '',
                                         thresholdsForPCWeightSignificance = 0.05),
                      MerfishB2B3 = list(datasetID = 'MerfishB2B3',
                                         cellType = 'U2OS',
                                         sequTechnique = 'Merfish',
                                         dataPath = '~/Studium Doktorarbeit/ExperimentalData/Merfish/MerfishB2B3.rds',
                                         intronDataExists = FALSE,
                                         intronicDataPath = '',
                                         doStabilityAnalysis = FALSE,
                                         lowernGeneCutoff = 5000,
                                         uppernUMICutoff = 250000,
                                         ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                         ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                         ccPhaseAssignGeneBucketListSheetIndex = 1,
                                         ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                         ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                         ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                         ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                         pcaGenes = 'variableGenes',
                                         goldStandardWeights = '',
                                         thresholdsForPCWeightSignificance = 0.05),
                      MerfishB1 = list(datasetID = 'MerfishB1',
                                       cellType = 'U2OS',
                                       sequTechnique = 'Merfish',
                                       dataPath = '~/Studium Doktorarbeit/ExperimentalData/Merfish/MerfishB1.rds',
                                       intronDataExists = FALSE,
                                       intronicDataPath = '',
                                       doStabilityAnalysis = FALSE,
                                       lowernGeneCutoff = 5000,
                                       uppernUMICutoff = 250000,
                                       ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                       ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                       ccPhaseAssignGeneBucketListSheetIndex = 1,
                                       ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                       ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                       ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                       ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                       pcaGenes = 'variableGenes',
                                       goldStandardWeights = '',
                                       thresholdsForPCWeightSignificance = 0.05),
                      MerfishB2 = list(datasetID = 'MerfishB2',
                                       cellType = 'U2OS',
                                       sequTechnique = 'Merfish',
                                       dataPath = '~/Studium Doktorarbeit/ExperimentalData/Merfish/MerfishB2.rds',
                                       intronDataExists = FALSE,
                                       intronicDataPath = '',
                                       doStabilityAnalysis = FALSE,
                                       lowernGeneCutoff = 5000,
                                       uppernUMICutoff = 250000,
                                       ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                       ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                       ccPhaseAssignGeneBucketListSheetIndex = 1,
                                       ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                       ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                       ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                       ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                       pcaGenes = 'variableGenes',
                                       goldStandardWeights = '',
                                       thresholdsForPCWeightSignificance = 0.05),
                      MerfishB3 = list(datasetID = 'MerfishB3',
                                       cellType = 'U2OS',
                                       sequTechnique = 'Merfish',
                                       dataPath = '~/Studium Doktorarbeit/ExperimentalData/Merfish/MerfishB3.rds',
                                       intronDataExists = FALSE,
                                       intronicDataPath = '',
                                       doStabilityAnalysis = FALSE,
                                       lowernGeneCutoff = 5000,
                                       uppernUMICutoff = 250000,
                                       ccPhaseAssignBasedOnIndividualBatches = TRUE,
                                       ccPhaseAssignGeneBucketListFileLocation = '~/Studium Doktorarbeit/ExperimentalData/Others/Whitfield_CellCycle_GeneList_HeLa.xlsx',
                                       ccPhaseAssignGeneBucketListSheetIndex = 1,
                                       ccPhaseAssignThresholdForCorSingleGeneToAvgExpression = 0.2,
                                       ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores = 1,
                                       ccPhaseAssignThresholdHighestPhaseScore = 0.75,
                                       ccPhaseAssignThresholdSecondHighestPhaseScore = 0.5,
                                       pcaGenes = 'variableGenes',
                                       goldStandardWeights = '',
                                       thresholdsForPCWeightSignificance = 0.05))


  for (i in names(datasetInfo)){
    if (datasetInfo[[i]]$cellType == 'HeLa'){
      datasetInfo[[i]]$ccDurationG1 <- 6.88      #old(paper: Eukaryotic Cell Cycle Phases by a Stochastic Model): G1:8.9, S:8.2, G2:5.6*0.6, M:5.6*0.4
      datasetInfo[[i]]$ccDurationS <- 8.38       #values from: Hahn et al. 2009, Quantitative analysis of cell cycle phase durations and PC12 differentiation using fluorescent biosensors
      datasetInfo[[i]]$ccDurationG2 <- 3.05
      datasetInfo[[i]]$ccDurationM <- 1.02
      datasetInfo[[i]]$ccDurationTotal <- datasetInfo[[i]]$ccDurationG1+datasetInfo[[i]]$ccDurationS+datasetInfo[[i]]$ccDurationG2+datasetInfo[[i]]$ccDurationM
    }else{
      if (datasetInfo[[i]]$cellType  == 'HEK'){
        datasetInfo[[i]]$ccDurationG1 <- 0.487*19.33    #from cheng et al. 2008, Speedy/Ringo C regulates S and G2 phase progression in human cells
        datasetInfo[[i]]$ccDurationS <- 0.392*19.33
        datasetInfo[[i]]$ccDurationG2 <- 0.093*19.33
        datasetInfo[[i]]$ccDurationM <- 0.028*19.33
        datasetInfo[[i]]$ccDurationTotal <- datasetInfo[[i]]$ccDurationG1+datasetInfo[[i]]$ccDurationS+datasetInfo[[i]]$ccDurationG2+datasetInfo[[i]]$ccDurationM
      }else{
        if (datasetInfo[[i]]$cellType  == '3T3'){
          datasetInfo[[i]]$ccDurationG1 <- 8.15  #values from: Hahn et al. 2009, Quantitative analysis of cell cycle phase durations and PC12 differentiation using fluorescent biosensors
          datasetInfo[[i]]$ccDurationS <- 8.95
          datasetInfo[[i]]$ccDurationG2 <- 2.17
          datasetInfo[[i]]$ccDurationM <- 0.84
          datasetInfo[[i]]$ccDurationTotal <- datasetInfo[[i]]$ccDurationG1+datasetInfo[[i]]$ccDurationS+datasetInfo[[i]]$ccDurationG2+datasetInfo[[i]]$ccDurationM
        }else{
          datasetInfo[[i]]$ccDurationG1 <- 6.88
          datasetInfo[[i]]$ccDurationS <- 8.38
          datasetInfo[[i]]$ccDurationG2 <- 3.05
          datasetInfo[[i]]$ccDurationM <- 1.02
          datasetInfo[[i]]$ccDurationTotal <- datasetInfo[[i]]$ccDurationG1+datasetInfo[[i]]$ccDurationS+datasetInfo[[i]]$ccDurationG2+datasetInfo[[i]]$ccDurationM
        }
      }
    }
  }
  for (i in names(datasetInfo)){
    if (datasetInfo[[i]]$intronDataExists){
      datasetInfo[[i]]$velTimeStep <- 1
      datasetInfo[[i]]$velGammaCutOff <- 0.1
      datasetInfo[[i]]$velSpearmanCorCutOff <- 0.1
      datasetInfo[[i]]$velMeanUnsplicedCutOff <- 0.005
      datasetInfo[[i]]$velMeanSplicedCutOff <- 0.01
      datasetInfo[[i]]$velCCGridAmountOfPoints <- 50
      datasetInfo[[i]]$velCCGridSigma <- c(0.6, 1.5)
      datasetInfo[[i]]$velWhichThirdDimensionsToGetVelocityFor <- c(3, 4, 5)
    }
    if (datasetInfo[[i]]$doStabilityAnalysis){
      datasetInfo[[i]]$stabilityIndexNumberOfIntervals <- 10
      datasetInfo[[i]]$stabilityIndexCorrelationType <- 'pearson'
      datasetInfo[[i]]$stabilityIndexpValueForCorrelation <- 0.05
    }
  }

  return(datasetInfo)
}
getFilteredDataBynUMIAndnGeneThresholds <- function(dataList){
  startTime <- Sys.time()
  cat(paste(Sys.time(), ': filtering data by nGene and nUMI thresholds: ', sep = ''))

  dataList <- getStatisticsOnCellsAndGenes(dataList = dataList)

  filteredCells <- as.character(t(subset(dataList@cellInfo, nUMI<dataList@datasetInfo$uppernUMICutoff & nGene>dataList@datasetInfo$lowernGeneCutoff, select = 'cellID')))
  dataList@DGEs$countData <- dataList@DGEs$countData[,filteredCells]
  dataList@geneInfo <- filter(dataList@geneInfo, rowSums(dataList@DGEs$countData)>0)
  dataList@DGEs$countData <- dataList@DGEs$countData[rowSums(dataList@DGEs$countData)>0,]
  dataList@cellInfo <- filter(dataList@cellInfo, cellID%in%filteredCells)

  dataList <- getStatisticsOnCellsAndGenes(dataList = dataList)

  cat(paste(round(Sys.time()-startTime, 2), attr(Sys.time()-startTime, 'units'), '\n', sep = ''))
  return(dataList)
}
getStatisticsOnCellsAndGenes <- function(dataList){
  #raw data for current list element
  currentData <- dataList@DGEs$countData
  datasetName <- dataList@datasetInfo$datasetID
  #get batch information from column names (format expected: 'batchID_barcode')
  batchInfo <- colnames(currentData)%>%
    {do.call(rbind, strsplit(., '_'))}
  if (dim(batchInfo)[2]>1){
    batchInfo <- batchInfo[,1]
  }else{
    batchInfo <- rep(paste(datasetName, 'Batch1', sep = ''), dim(currentData)[2])
  }
  #calculate statistics on cells and write them to a data frame
  statisticsOnCells <- data.frame('datasetID' = rep(datasetName, dim(currentData)[2]), 'batchID' = batchInfo,  'cellID' = colnames(currentData), 'nUMI' = colSums(currentData), 'nGene' = colSums(currentData>0))
  statisticsOnCells[,'datasetID'] <- factor(statisticsOnCells[,'datasetID'], levels = datasetName)
  statisticsOnCells[,'batchID'] <- factor(statisticsOnCells[,'batchID'], levels = unique(batchInfo))
  statisticsOnCells[,'cellID'] <- as.character(statisticsOnCells[,'cellID'])

  #calculate statistics on genes and write them to a data frame
  statisticsOnGenes <- data.frame('datasetID' = rep(datasetName, dim(currentData)[1]), 'geneID' = rownames(currentData), 'nUMI' = rowSums(currentData), 'nCell' = rowSums(currentData>0))
  statisticsOnGenes[,'datasetID'] <- factor(statisticsOnGenes[,'datasetID'], levels = datasetName)
  statisticsOnGenes[,'geneID'] <- as.character(statisticsOnGenes[,'geneID'])

  # if (boolIncludeStatisticsOnBatches){
  #   for (j in levels(statisticsOnCells[,'batchID'])){
  #     currentDataBatch <- currentData[, statisticsOnCells[,'batchID']==j]
  #     currentDataBatch <- currentDataBatch[rowSums(currentDataBatch)>0,]
  #     listOfStatisticsOnCells[[j]] <- data.frame('datasetID' = rep(datasetName, dim(currentDataBatch)[2]), 'batchID' = rep(j, dim(currentDataBatch)[2]),  'cellID' = colnames(currentDataBatch), 'nUMI' = colSums(currentDataBatch), 'nGene' = colSums(currentDataBatch>0))
  #     listOfStatisticsOnCells[[j]][,'datasetID'] <- factor(listOfStatisticsOnCells[[j]][,'datasetID'], levels = datasetName)
  #     listOfStatisticsOnCells[[j]][,'batchID'] <- factor(listOfStatisticsOnCells[[j]][,'batchID'], levels = j)
  #     listOfStatisticsOnCells[[j]][,'cellID'] <- as.character(listOfStatisticsOnCells[[j]][,'cellID'])
  #
  #     #calculate statistics on genes and write them to a data frame
  #     listOfStatisticsOnGenes[[j]] <- data.frame('datasetID' = rep(datasetName, dim(currentDataBatch)[1]), 'geneID' = rownames(currentDataBatch), 'nUMI' = rowSums(currentDataBatch), 'nCell' = rowSums(currentDataBatch>0))
  #     listOfStatisticsOnGenes[[j]][,'datasetID'] <- factor(listOfStatisticsOnGenes[[j]][,'datasetID'], levels = datasetName)
  #     listOfStatisticsOnGenes[[j]][,'geneID'] <- as.character(listOfStatisticsOnGenes[[j]][,'geneID'])
  #   }
  # }
  if (length(dataList@cellInfo)==0){
    dataList@cellInfo <- statisticsOnCells
  }else{
    dataList@cellInfo[,colnames(statisticsOnCells)] <- statisticsOnCells
  }
  if (length(dataList@geneInfo)==0){
    dataList@geneInfo <- statisticsOnGenes
  }else{
    dataList@geneInfo[,colnames(statisticsOnGenes)] <- statisticsOnGenes
  }
  #rm(currentData, batchInfo)
  return(dataList)
}
getCellCyclePhaseAssignInformation <- function(dataList){
  startTime <- Sys.time()
  cat(paste(Sys.time(), ': assigning cell cycle phases: ', sep = ''))

  dataList@datasetInfo$scalingFactorUMI <- median(dataList@cellInfo$nUMI)
  dataList@DGEs$logOfFractionsData <- getLogOfFractionsData(data = dataList@DGEs$countData,
                                                            scalingFactorUMI = dataList@datasetInfo$scalingFactorUMI)

  resultList <- cellCyclePhaseAssign(data = dataList@DGEs$logOfFractionsData,
                                     batchIDInformation = dataList@cellInfo[,'batchID'],
                                     boolBaseColouringOnIndividualReplicates = dataList@datasetInfo$ccPhaseAssignBasedOnIndividualBatches,
                                     geneBucketListFileLocation = dataList@datasetInfo$ccPhaseAssignGeneBucketListFileLocation,
                                     geneBucketListSheetIndex = dataList@datasetInfo$ccPhaseAssignGeneBucketListSheetIndex,
                                     corScoreGeneToAvgExprThreshold = dataList@datasetInfo$ccPhaseAssignThresholdForCorSingleGeneToAvgExpression)
  phaseScore <- resultList[['phaseScore']]
  phaseScoreNormalized <- resultList[['phaseScoreNormalized']]
  colnames(phaseScoreNormalized) <- paste(colnames(phaseScoreNormalized), '_zScore', sep = '')
  phaseAssignStatistics <- data.frame(ccPhase = resultList[['ccPhase']], meanOfPhaseScore = apply(resultList[['phaseScore']], 1, mean), sdOfPhaseScore = apply(resultList[['phaseScore']], 1, sd), highestPhaseScore = resultList[['highestPhaseScore']], secondHighestPhaseScore = resultList[['secondHighestPhaseScore']])
  phaseAssignStatistics <- cbind(phaseAssignStatistics, phaseScore, phaseScoreNormalized)
  dataList@geneInfo <- cbind(dataList@geneInfo, ccPhase = resultList[['geneCCPhase']])

  #get outliers
  phaseDifferenceBetweenHighestAndSecondHighest <- t(subset(phaseAssignStatistics, select = colnames(phaseScoreNormalized)))
  highestPhaseScoreIndex <- apply(phaseDifferenceBetweenHighestAndSecondHighest, 2, which.max)
  highestPhaseScoreIndexOfMatrix <- (1:length(highestPhaseScoreIndex))*dim(phaseDifferenceBetweenHighestAndSecondHighest)[1]-dim(phaseDifferenceBetweenHighestAndSecondHighest)[1]+highestPhaseScoreIndex
  phaseDifferenceBetweenHighestAndSecondHighest[highestPhaseScoreIndexOfMatrix] <- -5
  secondHighestPhaseScoreIndex <- apply(phaseDifferenceBetweenHighestAndSecondHighest, 2, which.max)
  differenceHighestIndexToSecondIndex <- apply(cbind(abs(highestPhaseScoreIndex - secondHighestPhaseScoreIndex), abs(highestPhaseScoreIndex + dim(phaseDifferenceBetweenHighestAndSecondHighest)[1] - secondHighestPhaseScoreIndex), abs(highestPhaseScoreIndex - dim(phaseDifferenceBetweenHighestAndSecondHighest)[1] - secondHighestPhaseScoreIndex)), 1, min)
  isOutlierSuspectedDoublets <- as.logical(rep(FALSE, dim(phaseAssignStatistics)[1]))
  isOutlierNoConfidenceInPhaseScore <- as.logical(rep(FALSE, dim(phaseAssignStatistics)[1]))
  isOutlierSuspectedDoublets[which((differenceHighestIndexToSecondIndex>dataList@datasetInfo$ccPhaseAssignMaxDiffOfCCPhasesBetweenHighestScores)&(phaseAssignStatistics[,'secondHighestPhaseScore']>dataList@datasetInfo$ccPhaseAssignThresholdSecondHighestPhaseScore))] <- TRUE
  isOutlierNoConfidenceInPhaseScore[which(phaseAssignStatistics[,'highestPhaseScore']<dataList@datasetInfo$ccPhaseAssignThresholdHighestPhaseScore)] <- TRUE
  phaseAssignStatistics <- cbind(phaseAssignStatistics, isOutlierSuspectedDoublets, isOutlierNoConfidenceInPhaseScore)

  #combine data
  dataList@cellInfo <- cbind(dataList@cellInfo, phaseAssignStatistics)

  cat(paste(round(Sys.time()-startTime, 2), attr(Sys.time()-startTime, 'units'), '\n', sep = ''))
  return(dataList)
}
cellCyclePhaseAssign <- function(data,
                                 batchIDInformation,
                                 boolBaseColouringOnIndividualReplicates,
                                 nameSeparationSymbol = '_',
                                 geneBucketListFileLocation,
                                 geneBucketListSheetIndex,
                                 corScoreGeneToAvgExprThreshold){

  #read excel file containing cell cycle genes for different phases
  geneCategoriesExternal <- read.xlsx(geneBucketListFileLocation, geneBucketListSheetIndex)

  #get category names
  ccPhaseNames <- colnames(geneCategoriesExternal)

  dataAll <- data
  scoreForEachCCPhase <- as.data.frame(matrix(0L, dim(dataAll)[2], length(ccPhaseNames)))
  rownames(scoreForEachCCPhase) <- colnames(dataAll)
  colnames(scoreForEachCCPhase) <- ccPhaseNames
  ccPhaseInformationHelpAll <- NULL
  namesCCPhaseInformation <- NULL
  phaseScoreCellsBeforeNormalizationAll <- NULL
  phaseScoreCellsAll <- NULL
  highestPhaseScoreAll <- NULL
  secondHighestPhaseScoreAll <- NULL
  if (!boolBaseColouringOnIndividualReplicates){
    replicateNamesSave <- sort(unique(batchIDInformation))
    replicateNames <- 1
    replicateIDInformationSave <- batchIDInformation
    batchIDInformation <- rep(1, length(batchIDInformation))
  }else{
    replicateNames <- sort(unique(batchIDInformation))
  }
  for (k in replicateNames){
    data <- dataAll[, batchIDInformation==k]
    #initiate data frame
    geneNames <- t(data.frame(matrix(NA, nrow = length(ccPhaseNames), ncol = dim(geneCategoriesExternal)[1]), row.names = ccPhaseNames))

    #get all genes from excel file which are actually present in data
    for (i in 1:length(ccPhaseNames)){
      geneNames[1:(length(geneCategoriesExternal[,i])), i] <- gsub(" ", "", geneCategoriesExternal[,i])
      number.Of.Genes.In.Data <- sum(geneNames[,i] %in% rownames(data))
      geneNames[1:number.Of.Genes.In.Data, i] <- geneNames[(geneNames[,i] %in% rownames(data)), i]
      geneNames[(number.Of.Genes.In.Data+1):dim(geneCategoriesExternal)[1], i] <- NA
    }

    #delete zero genes
    for (i in 1:length(ccPhaseNames)){
      notNAGeneNames <- geneNames[!is.na(geneNames[, i]), i]
      indexOfZeroGenes <- which(rowSums(data[notNAGeneNames,]) == 0)
      if (length(indexOfZeroGenes)>0){
        geneNames[1:(length(notNAGeneNames)-length(indexOfZeroGenes)), i] <- notNAGeneNames[-indexOfZeroGenes]
        geneNames[(length(notNAGeneNames)-length(indexOfZeroGenes)+1):dim(geneCategoriesExternal)[1], i] <- NA
      }
    }

    #delete empty rows
    geneNames <- geneNames[rowSums(is.na(geneNames))<length(ccPhaseNames),]
    geneNamesSave <- geneNames

    #average gene expression pattern per phase
    avgExprPattern <- data.frame(matrix(0L, dim(data)[2], length(ccPhaseNames)))
    colnames(avgExprPattern) <- colnames(geneNames)
    for (i in 1:length(ccPhaseNames)){
      avgExprPattern[,i] <- colMeans(data[geneNames[!is.na(geneNames[,i]), i],])
    }

    #score for each gene compared to genes in the same category
    corScore <- matrix(0L, dim(geneNames)[1], length(ccPhaseNames))
    for (i in 1:length(ccPhaseNames)){
      for (j in 1:sum(!is.na(geneNames[,i]))){
        corScore[j,i] <- cor(as.numeric(t(data[geneNames[j,i],])), as.numeric(avgExprPattern[,i]))
      }
    }

    #filter out genes behaving differently in our data
    for (i in 1:length(ccPhaseNames)){
      numberOfValidGenes <- sum(corScore[,i] > corScoreGeneToAvgExprThreshold)
      geneNames[1:numberOfValidGenes, i] <- geneNames[corScore[,i] > corScoreGeneToAvgExprThreshold, i]
      if (numberOfValidGenes<(dim(geneNames)[1])){
        geneNames[(numberOfValidGenes+1):dim(geneNames)[1], i] <- NA
      }
    }

    #delete empty rows
    geneNames <- geneNames[rowSums(is.na(geneNames))<length(ccPhaseNames),]

    #score for each cell in each category
    phaseScoreCells <- data.frame(matrix(0L, dim(data)[2], length(ccPhaseNames)))
    rownames(phaseScoreCells) <- colnames(data)
    colnames(phaseScoreCells) <- ccPhaseNames
    for (j in 1:length(ccPhaseNames)){
      phaseScoreCells[,j] <- colMeans(data[geneNames[!is.na(geneNames[,j]), j], ], na.rm=TRUE)
    }
    phaseScoreCellsBeforeNormalization <- phaseScoreCells

    #scale the scores
    phaseScoreCells <- as.data.frame(apply(phaseScoreCells, 2, scale))
    phaseScoreCells <- as.data.frame(t(apply(phaseScoreCells, 1, scale)))
    rownames(phaseScoreCells) <- colnames(data)
    colnames(phaseScoreCells) <- ccPhaseNames

    #assign highest score
    phaseAssign <- apply(phaseScoreCells, 1, which.max)

    phaseScoreCellsSecond <- t(phaseScoreCells)
    maxIndexPerCell <- (1:length(phaseAssign))*length(ccPhaseNames)-length(ccPhaseNames)+phaseAssign
    phaseScoreCellsSecond[maxIndexPerCell] <- -9
    phaseScoreCellsSecond <- t(phaseScoreCellsSecond)

    highestPhaseScore <- apply(phaseScoreCells, 1, max)
    secondHighestPhaseScore <- apply(phaseScoreCellsSecond, 1, max)

    ccPhaseNames <- colnames(phaseScoreCells)
    ccPhaseInformation <- ccPhaseNames[phaseAssign]
    ccPhaseNames <- ccPhaseNames[as.numeric(names(table(phaseAssign)))]

    orderNecessary <- match(ccPhaseNames,ccPhaseNames[order(ccPhaseNames)])

    ccPhaseInformationHelpAll <- append(ccPhaseInformationHelpAll,as.character(ccPhaseInformation))
    namesCCPhaseInformation <- append(namesCCPhaseInformation,colnames(data))

    phaseScoreCellsBeforeNormalizationAll <- rbind(phaseScoreCellsBeforeNormalizationAll, phaseScoreCellsBeforeNormalization)
    phaseScoreCellsAll <- rbind(phaseScoreCellsAll, phaseScoreCells)
    highestPhaseScoreAll <- append(highestPhaseScoreAll, highestPhaseScore)
    secondHighestPhaseScoreAll <- append(secondHighestPhaseScoreAll, secondHighestPhaseScore)
  }
  if (!boolBaseColouringOnIndividualReplicates){
    batchIDInformation <- replicateIDInformationSave
    replicateNames <- sort(unique(batchIDInformation))
  }
  data <- dataAll
  matchHelp <- match(colnames(data),namesCCPhaseInformation)
  ccPhaseInformationHelpAll <- ccPhaseInformationHelpAll[matchHelp]
  namesCCPhaseInformation <- namesCCPhaseInformation[matchHelp]
  ccPhaseInformationHelpAll <- as.factor(ccPhaseInformationHelpAll)
  ccPhaseInformationAlgorithm <- factor(ccPhaseInformationHelpAll, levels = levels(ccPhaseInformationHelpAll)[orderNecessary])
  names(ccPhaseInformationAlgorithm) <- namesCCPhaseInformation

  ccPhaseAssignOfGenes <- rep('-', dim(data)[1])
  names(ccPhaseAssignOfGenes) <- rownames(data)
  for (i in levels(ccPhaseInformationAlgorithm)){
    ccPhaseAssignOfGenes[geneNamesSave[!is.na(geneNamesSave[,i]),i]] <- i
  }
  ccPhaseAssignOfGenes <- factor(ccPhaseAssignOfGenes, levels = c(levels(ccPhaseInformationAlgorithm), '-'))

  return(list(ccPhase = ccPhaseInformationAlgorithm, phaseScore = phaseScoreCellsBeforeNormalizationAll, phaseScoreNormalized = phaseScoreCellsAll, highestPhaseScore = highestPhaseScoreAll, secondHighestPhaseScore = secondHighestPhaseScoreAll, geneCCPhase = ccPhaseAssignOfGenes))
}
getLogOfFractionsData <- function(data,
                                  scalingFactorUMI){

  countUMIPerCell <- colSums(data)                                   #gives total UMI count per cell
  data <- sweep(data,2,countUMIPerCell,'/')                          #divides each column by total UMI count for that cell
  data <- data*scalingFactorUMI                                                     #multiplies every entry by 10^4 as a scaling factor
  data <- log(data+1)                                                   #transforms to logarithmic scale (natural logarithm)

  return(data)
}

getFilteredDataByCCPhaseAssignOutliers <- function(dataList){
  startTime <- Sys.time()
  cat(paste(Sys.time(), ': filtering data by cc phase outliers: ', sep = ''))

  filteredCells <- as.character(t(subset(dataList@cellInfo, !(isOutlierSuspectedDoublets|isOutlierNoConfidenceInPhaseScore), select = 'cellID')))
  dataList@DGEs$countData <- dataList@DGEs$countData[,filteredCells]
  dataList@geneInfo <- filter(dataList@geneInfo, rowSums(dataList@DGEs$countData)>0)
  dataList@DGEs$countData <- dataList@DGEs$countData[rowSums(dataList@DGEs$countData)>0,]
  dataList@cellInfo <- filter(dataList@cellInfo, cellID%in%filteredCells)

  dataList <- getStatisticsOnCellsAndGenes(data = dataList)

  cat(paste(round(Sys.time()-startTime, 2), attr(Sys.time()-startTime, 'units'), '\n', sep = ''))
  return(dataList)
}
